# Default values for chart.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
# Customize the following values as needed

fullnameOverride: "viva-staging"

postgresql:
  enabled: false

externalPostgresql:
  host: pg-postgresql.staging-postgres.svc.cluster.local
  username: postgres
  password: $DATABASE_PASSWORD

web:
  replicaCount: 1
  resources:
    limits:
      memory: "3Gi"
      cpu: "400m"
    requests:
      memory: "1.5Gi"
      cpu: "200m"

rails:
  image:
    repository: ghcr.io/scientist-softserv/viva
    # Overrides the image tag whose default is the chart appVersion.
    tag: ""
  imagepullPolicy: IfNotPresent
  imagePullSecrets:
    - name: github
  shared:
    storage:
      size: 1Gi
      className: nfs

service:
  type: ClusterIP
  port: 80

ingress:
  enabled: true
  hosts:
    - host: viva-staging.notch8.cloud
      paths:
        - path: /
          pathType: ImplementationSpecific
  annotations: {
    kubernetes.io/ingress.class: "nginx",
    nginx.ingress.kubernetes.io/proxy-body-size: "0",
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  }
  tls:
    - hosts:
        - viva-staging.notch8.cloud
      secretName: viva-staging-tls

env:
  configmap:
    DATABASE_ADAPTER: postgresql
    DATABASE_HOST: pg-postgresql.staging-postgres.svc.cluster.local
    DATABASE_NAME: viva-staging
    DATABASE_PASSWORD: $DATABASE_PASSWORD
    DATABASE_USER: postgres
    RAILS_ENV: production
    RAILS_SERVE_STATIC_FILES: true
    RAILS_LOG_TO_STDOUT: true
    SECRET_KEY_BASE: $SECRET_KEY_BASE
