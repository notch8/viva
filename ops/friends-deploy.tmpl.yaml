# Default values for chart.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.
# Customize the following values as needed
postgresql:
  enabled: false

externalPostgresql:
  host: postgres-postgresql.postgres.svc.cluster.local
  username: postgres
  password: $DATABASE_PASSWORD

web:
  replicaCount: 1
  resources:
    limits:
      memory: "2Gi"
      cpu: "1000m"
    requests:
      memory: "1Gi"
      cpu: "100m"

rails:
  image:
    repository: ghcr.io/notch8/viva
    # Overrides the image tag whose default is the chart appVersion.
    tag: ""
  imagepullPolicy: IfNotPresent
  imagePullSecrets:
    - name: github
  shared:
    storage:
      size: 1Gi
      className: aws-efs

ingress:
  enabled: true
  hosts:
    - viva-friends.notch8.cloud
  annotations: {
    kubernetes.io/ingress.class: "nginx",
    nginx.ingress.kubernetes.io/proxy-body-size: "0",
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  }
  tlsSecretName: viva-friends-tls

env:
  configmap:
    NAME: viva-friends
    DATABASE_ADAPTER: postgresql
    DATABASE_HOST: postgres-postgresql.postgres.svc.cluster.local
    DATABASE_NAME: viva-friends
    DATABASE_PASSWORD: $DATABASE_PASSWORD
    DATABASE_USER: postgres
    RAILS_ENV: production
    # URL configuration for email links (used by Devise and other mailers)
    APP_HOST: viva-friends.notch8.cloud
    APP_PROTOCOL: https
    # Enable letter_opener_web for client demos (admin-only access at /letter_opener)
    # To disable for real production: remove this line or set to empty string
    ENABLE_LETTER_OPENER: "true"
    RAILS_SERVE_STATIC_FILES: true
    RAILS_LOG_TO_STDOUT: true
    SECRET_KEY_BASE: $SECRET_KEY_BASE
